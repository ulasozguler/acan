<script src="js/utils.js"></script>
<script src="js/grid.js"></script>
<script src="js/world.js"></script>
<script src="js/simulation-interface.js"></script>
<script src="js/examples/game-of-life.js"></script>
<link rel="stylesheet" href="main.css"/>

<canvas id="test"></canvas>

<div id="controls">
    <a id="run">Run</a>
    <a id="pause">Pause</a>
    <a id="step">Step</a>
    <a id="reset">Reset</a>
</div>

<div id="legend">dsads</div>


<script>
    var simulation = GameOfLife;
    var width = 75;
    var height = 50;
    var stepDelay = 100;

    var w = new World(width, height);
    w.setSimulation(simulation);

    var grid = new Grid('test', width, height);
    if(simulation.colorPicker) {
        grid.colorPicker = simulation.colorPicker;
    }

    function redraw() {
        grid.updateData(w.getData());
        document.getElementById('legend').innerHTML = grid.getColorMapHTML();
    }

    function step() {
        w.step();
        redraw();
    }

    // ui stuff
    var paused = true;
    function run() {
        step();
        if(!paused) {
            setTimeout(run, stepDelay);
        }
    }

    var runButton = document.getElementById('run');
    var pauseButton = document.getElementById('pause');

    runButton.addEventListener('click', function() {
        if(paused) {
            paused = false;
            run();
            runButton.style.display = 'none';
            pauseButton.style.display = 'block';
        }
    });

    pauseButton.style.display = 'none';
    pauseButton.addEventListener('click', function() {
        paused = true;
        runButton.style.display = 'block';
        pauseButton.style.display = 'none';
    });

    document.getElementById('step').addEventListener('click', step);

    document.getElementById('reset').addEventListener('click', function() {
        w.reset();
        redraw();
    });

    // initial
    window.onload = function() {
        redraw();
    };
</script>
